import{getCountTask,getCountTaskPending,getCountTaskCompleted}from"./sidebar.js";function startApp(){btnAddTask(),getTask()}document.addEventListener("DOMContentLoaded",startApp);let tasks=[],filteredTasks=[];const inputSearch=document.getElementById("search-input");function filterTasksBySearch(){const t=inputSearch.value.trim().toLowerCase();filteredTasks=""!==t?tasks.filter(e=>e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)):[],showTasks()}inputSearch.addEventListener("input",filterTasksBySearch);const filters=document.getElementById("filters");function filterTask(t){const e=t.target.value;filteredTasks=""!==e?tasks.filter(t=>t.state===e||t.priority===e):[],showTasks()}async function getTask(){try{const t="http://localhost:3000/api/tasks",e=await fetch(t),a=await e.json();tasks=a.tasks,showTasks()}catch(t){return void message("error","An unexpected error occurred while getting the project!","Reload the page or try again later")}}function btnAddTask(){document.getElementById("btn-add-task").addEventListener("click",()=>{modal()})}function modal(t=!1,e={}){Swal.fire({title:""+(t?"Edite task details":"Enter task details"),html:`\n            <div class="container-task">\n                <div class="container-task__item">\n                    <label for="task-title" class="swal2-label">Task Title:</label>\n                    <input type="text" id="task-title" placeholder="${t?"Edite title task...":"Task title here..."}" class="swal2-input" value="${e.title?e.title:""}">\n                </div>\n                <div class="container-task__item">\n                    <label for="task-description" class="swal2-label">Task Description:</label>\n                    <textarea id="task-description" placeholder="${t?"Edite description task...":"Task description here..."}" class="swal2-textarea">${e.description?e.description:""}</textarea>\n                </div>\n                <div class="container-task__item">\n                    <label for="task-priority" class="swal2-label">Priority:</label>\n                    <select id="task-priority" class="swal2-select">\n                        <option value="${e.priority?e.priority:""}" selected disabled >${e.priority?"Set priority: "+e.priority:"Select an option"}</option>\n                        <option value="low">Low</option>\n                        <option value="medium">Medium</option>\n                        <option value="high">High</option>\n                    </select>\n                </div>\n            </div>\n        `,showCancelButton:!0,showCloseButton:!0,confirmButtonText:""+(t?"Save changes":"Add Task"),confirmButtonColor:"#697199",cancelButtonText:"Cancel",cancelButtonColor:"#DC3741",preConfirm:()=>{const t=document.getElementById("task-title").value.trim(),e=document.getElementById("task-description").value.trim(),a=document.getElementById("task-priority").value.trim();if(""===t||""===e||""===a)return Swal.showValidationMessage("Make sure all fields are complete."),!1}}).then(a=>{if(1==a.isConfirmed){const a=document.getElementById("task-title").value.trim(),n=document.getElementById("task-description").value.trim(),s=document.getElementById("task-priority").value;t?(e.title=a,e.description=n,e.priority=s,updateTask(e)):createTask(a,n,s)}})}async function createTask(t,e,a){const n=new FormData;n.append("title",t),n.append("description",e),n.append("priority",a);try{const s="http://localhost:3000/api/task/create",i=await fetch(s,{method:"POST",body:n}),o=await i.json();if("success"===o.type){message("success","Task Created Successfully","The task was created successfully!");const n={id:String(o.id),title:t,description:e,priority:a,creation_date:o.creation_date,owner_id:o.owner_id,state:"pending"};tasks=[...tasks,n];const s=filters.value;""!==s&&n.state!==s&&n.priority!==s||(filteredTasks=[...filteredTasks,n]),getCountTask(),getCountTaskPending(),getCountTaskCompleted(),showTasks()}}catch(t){return void message("error","Task Create Failed","An error occurred while creating the task, please try again later!")}}function changeState(t){Swal.fire({icon:"question",title:"Do you want to update the status of the task?",showDenyButton:!0,showCloseButton:!0,confirmButtonText:"Update",denyButtonText:"Cancel",confirmButtonColor:"#697199"}).then(e=>{if(e.isConfirmed){const e="completed"===t.state?"pending":"completed";t.state=e,updateTask(t)}})}async function updateTask(t){const{id:e,title:a,description:n,priority:s,state:i,owner_id:o,creation_date:d}=t,l=new FormData;l.append("id",e),l.append("title",a),l.append("description",n),l.append("priority",s),l.append("state",i),l.append("owner_id",o),l.append("creation_date",d);try{const t="http://localhost:3000/api/task/update",o=await fetch(t,{method:"POST",body:l});"success"===(await o.json()).type&&message("success","Task Status Updated","The task was updated successfully!"),tasks=tasks.map(t=>(t.id===e&&(t.title=a,t.description=n,t.priority=s,t.state=i),t)),getCountTaskPending(),getCountTaskCompleted(),showTasks()}catch(t){return void message("error","Task Updatgin Failed","An error occurred while updating the task, please try again later!")}}function confirmDeleteTask(t){Swal.fire({icon:"question",title:"Are you sure you want to delete the task?",showCancelButton:!0,showCloseButton:!0,confirmButtonText:"Delete",cancelButtonText:"Cancel",confirmButtonColor:"#697199"}).then(e=>{e.isConfirmed&&deleteTask(t)})}async function deleteTask(t){const{id:e,title:a,description:n,priority:s,state:i,owner_id:o,creation_date:d}=t,l=new FormData;l.append("id",e),l.append("title",a),l.append("description",n),l.append("priority",s),l.append("state",i),l.append("owner_id",o),l.append("creation_date",d);try{const e="http://localhost:3000/api/task/delete",a=await fetch(e,{method:"POST",body:l});"success"===(await a.json()).type&&(message("success","Task Deleted Succesffully","The task was deleted successfully!"),tasks=tasks.filter(e=>e.id!==t.id),filteredTasks=filteredTasks.filter(e=>e.id!==t.id),0===filteredTasks.length&&(filters.value=""),getCountTask(),getCountTaskPending(),getCountTaskCompleted(),showTasks())}catch(t){return void message("error","Task deleted Failed","An error occurred while deleting the task, please try again later!")}}function viewTask(t){Swal.fire({html:`\n            <div class="view-task text-start">\n                <div class="d-flex flex-column">\n                    <p class="view-task__header fs-5 mb-1">Created on the day: <span class="fw-bold">${t.creation_date}</span></p>\n                </div>\n                <div>\n                    <h1 class="view-task__title fw-bold mb-2">${t.title}</h1>\n                    <p class="view-task__description fs-4">Description: ${t.description}</p>\n                </div>\n                <div class="d-flex align-items-center justify-content-end gap-3 mt-5 border-top pt-3">\n                    <p class="view-task__info fs-5 fw-semibold text-capitalize mb-0">Status: <span class="view-task__span-state" id="span-state">${t.state}</span></p>\n                    <p class="view-task__info fs-5 fw-semibold text-capitalize mb-0">Priority: <span class="view-task__span" id="span-priority">${t.priority}</span></p>\n                </div>\n            </div>\n        `,showCloseButton:!0,showConfirmButton:!1});const e=document.getElementById("span-state"),a=document.getElementById("span-priority");"low"===t.priority?a.classList.add("view-task__span--low"):"medium"===t.priority?a.classList.add("view-task__span--medium"):a.classList.add("view-task__span--high"),"completed"===t.state?e.classList.add("view-task__span-state--complete"):e.classList.add("view-task__span-state--pending")}function showTasks(){clearHTML(),pendingTotal(),completedTotal(),lowTotal(),mediumTotal(),highTotal();const t=filteredTasks.length?filteredTasks:tasks;if(0===t.length){const t=document.createElement("DIV");t.className="d-flex justify-content-center alert w-100";const e=document.createElement("DIV");return e.className="alert alert-danger fs-3 fw-semibold text-center w-auto",e.setAttribute="alert",e.textContent="It looks like you haven`t added any tasks yet, start by adding a task!",t.appendChild(e),void document.getElementById("content-task").appendChild(t)}const e={pending:"pending",completed:"complete"},a={low:"low",medium:"medium",high:"high"};t.forEach(t=>{const n=document.createElement("DIV");n.className="card rounded-4 ";const s=document.createElement("DIV");s.className="card__content-card m-4";const i=document.createElement("DIV");i.className="d-flex align-items-center justify-content-between";const o=document.createElement("SPAN");o.classList.add("card__span-priority"),o.classList.add(""+a[t.priority]),o.dataset.priorityTask=t.priority,"low"===t.priority?o.classList.add("card__span-priority--low"):"medium"===t.priority?o.classList.add("card__span-priority--medium"):"high"===t.priority&&o.classList.add("card__span-priority--high");const d=document.createElement("DIV");d.innerHTML='\n            <button type="button" class="btn-drop-down btn-outline-transparent bg-transparent" data-bs-toggle="dropdown" aria-expanded="false" aria-label="button with actions">\n                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" />\n                </svg>\n            </button>\n        ';const l=document.createElement("UL");l.classList.add("dropdown-menu","p-2");const r=document.createElement("LI"),c=document.createElement("BUTTON");c.setAttribute("type","button"),c.className="button-actions rounded button-actions--edite d-flex align-items-center gap-3 w-100 fs-4 mb-2",c.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" />\n            </svg>\n            <span>Edite</span>\n        ',c.onclick=function(){modal(!0,{...t})};const p=document.createElement("LI"),u=document.createElement("BUTTON");u.setAttribute("type","button"),u.className="button-actions rounded button-actions--delete d-flex align-items-center gap-3 w-100 fs-4",u.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n                <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />\n            </svg>\n            <span>Delete</span>\n        ',u.onclick=function(){confirmDeleteTask(t)};const m=document.createElement("DIV");m.className="card__content mb-4",m.innerHTML=`\n            <h2 class="card__title fw-semibold m-0">${t.title}</h2>\n            <p class="card__description mt-2 fs-4">${t.description}</p>\n        `;const h=document.createElement("DIV");h.className="d-flex align-items-center justify-content-end gap-3";const k=document.createElement("BUTTON");k.setAttribute("type","button"),k.className="card__button-state rounded-2 fw-bold fs-5 text-uppercase px-3 "+e[t.state].toLowerCase(),k.textContent=e[t.state],k.dataset.stateTask=t.state,k.onclick=function(){changeState({...t})},"pending"===t.state?k.classList.add("card__button-state--pending"):k.classList.add("card__button-state--complete");const w=document.createElement("BUTTON");w.className="card__button-view rounded px-3",w.setAttribute("aria-label","Button for view more information about task"),w.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">\n                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>\n                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>\n            </svg>\n        ',w.onclick=function(){viewTask(t)},n.appendChild(s),s.appendChild(i),i.appendChild(o),i.appendChild(d),r.appendChild(c),p.appendChild(u),l.appendChild(r),l.appendChild(p),d.appendChild(l),s.appendChild(m),s.appendChild(h),h.appendChild(k),h.appendChild(w),document.getElementById("content-task").appendChild(n)})}function pendingTotal(){const t=tasks.filter(t=>"pending"===t.state),e=document.getElementById("pending");0===t.length?e.disabled=!0:e.disabled=!1}function completedTotal(){const t=tasks.filter(t=>"completed"===t.state),e=document.getElementById("completed");0===t.length?e.disabled=!0:e.disabled=!1}function lowTotal(){const t=tasks.filter(t=>"low"===t.priority),e=document.getElementById("low");0===t.length?e.disabled=!0:e.disabled=!1}function mediumTotal(){const t=tasks.filter(t=>"medium"===t.priority),e=document.getElementById("medium");0===t.length?e.disabled=!0:e.disabled=!1}function highTotal(){const t=tasks.filter(t=>"high"===t.priority),e=document.getElementById("high");0===t.length?e.disabled=!0:e.disabled=!1}function message(t,e,a){Swal.fire({position:"top-end",icon:t,title:e,text:a,showConfirmButton:!1,allowOutsideClick:!1,timer:2e3})}function clearHTML(){const t=document.getElementById("content-task");for(;t.firstChild;)t.removeChild(t.firstChild)}filters.addEventListener("change",filterTask);
//# sourceMappingURL=tasks.js.map
